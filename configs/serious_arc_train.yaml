model:
  num_colors: 10
  dim: 96
  depth: 4
  heads: 8
  reasoner_max_steps: 12
  decoder_refine_steps: 6

train:
  steps: 12000
  lr: 0.00015
  weight_decay: 0.0001
  grad_clip: 1.0
  device: cpu
  replay_ratio: 0.35
  replay_capacity: 2048
  log_every: 100
  sft_warmup_steps: 4500
  min_sft_weight: 0.35
  sft_refresh_interval: 500
  sft_refresh_span: 120
  sft_refresh_min: 0.62
  routing_explore_steps: 3000
  routing_explore_floor: 0.20
  routing_entropy_bonus: 0.03
  adapt_structure: true
  adapt_interval: 1
  grow_threshold: 0.38
  prune_threshold: 0.10
  structure_ema_momentum: 0.92
  hard_expert_cap: 6
  target_expert_cap: 5
  growth_force_until_step: 3000
  growth_force_interval: 300
  growth_force_exact_threshold: 0.2
  expert_budget_coeff: 0.35
  compute_penalty_coeff: 0.004
  reward_pixel_coeff: 0.05
  reward_exact_coeff: 1.0
  metrics_jsonl_path: logs/serious_arc_train_metrics.jsonl
  rolling_window: 200
  show_progress_bar: true

stream:
  source: episodes_jsonl
  episodes_file: data/arc_400_tasks_12k_episodes.jsonl
  arc_data_dir: ""
  split: training
  max_steps: 12000
  seed: 11
  same_shape_only: true
  require_test_output: true
  max_grid_size: 30

checkpoint_path: checkpoints/unified_arc_serious.pt
