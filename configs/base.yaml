model:
  num_colors: 10
  dim: 64
  depth: 2
  heads: 4
  h_layers: 1
  l_layers: 1
  h_cycles: 2
  l_cycles: 2
  shape_h_layers: 1
  shape_l_layers: 1
  shape_h_cycles: 1
  shape_l_cycles: 1
  decoder_refine_steps: 2
  use_mamba: false

train:
  steps: 100
  lr: 0.0003
  weight_decay: 0.0001
  grad_clip: 1.0
  device: cpu
  replay_ratio: 0.2
  replay_capacity: 64
  log_every: 10
  lr_warmup_steps: 20
  lr_min_ratio: 0.05
  grad_accum_steps: 1
  w_shape: 0.3
  w_aux: 0.3
  w_consistency: 0.02
  adapt_structure: true
  adapt_interval: 1
  grow_threshold: 0.55
  prune_threshold: 0.15
  structure_ema_momentum: 0.9
  hard_expert_cap: 4
  target_expert_cap: 3
  expert_budget_coeff: 0.25
  compute_penalty_coeff: 0.01
  metrics_jsonl_path: logs/base_train_metrics.jsonl
  rolling_window: 10
  show_progress_bar: true

stream:
  source: simulator
  max_steps: 100
  seed: 42
  same_shape_only: true
  require_test_output: true
  max_grid_size: 12
  sim_grid_min_size: 3
  sim_grid_max_size: 8
  sim_num_colors: 10
  sim_min_train_pairs: 2
  sim_max_train_pairs: 3

checkpoint_path: checkpoints/unified_arc.pt
